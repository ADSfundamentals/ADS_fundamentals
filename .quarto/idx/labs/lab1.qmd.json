{"title":"Lab 1","markdown":{"yaml":{"title":"Lab 1","output-file":"lab2.html","params":{"answers":false}},"headingText":"Introduction","containsRefs":false,"markdown":"\n\nFrom the [Open Statistical Programming](https://www.openstatprog.com/) modules, complete the following:\n\n-   Reproducible reporting\n\n-   External data\n\n------------------------------------------------------------------------\n\n\n\nWelcome to the first practical of Fundamental Techniques in Data Science with R! In this part of the practical, you will learn about \n\n* Pipes\n* Data transformation \n\n---\n\nWe will work with the following packages today: \n```{r, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(kableExtra)\n```\n\n\nWe are going to use the General Social Survey, which is a long-running [US survey](https://gss.norc.org/) conducted by the NORC at the University of Chicago. The survey monitors changes in social characteristics and attitudes. The survey is quite large, so we can access a smaller version in the `forcats` package. It has the following variables:\n\n* **year**: year of the survey from 2000-2014\n* **marital**: marital status\n* **age**: max age is truncated to 89\n* **race**\n* **rincome**: reported income\n* **partyid**: political affiliation\n* **relig**: religion\n* **denom**: denomination \n* **tvhours**: hours per day watching tv\n\nIf you want more information on the survey you can type `?gss_cat` into the console. \nLet's load the data. \n\n```{r}\ngss_cat <- forcats::gss_cat\n```\n\nWe can take a look at the data using `head()`, which shows us the first 6 rows of the data frame. \n\n```{r}\nhead(gss_cat)\n```\n\nThe `str()` function tells us what the class of each variable is. You will notice that most variables in the gss_cat data are factors with different levels. In this tutorial we will work mainly with these variables to learn techniques for working with factors. \n\n```{r}\nstr(gss_cat)\n```\n\n# Part 2: Pipes\n\nPipes are a useful tool that make it easier to express a sequence of multiple operations in R. Pipes ` %>% ` come from the `magrittr` package, so they are automatically loaded when you use the `tidyverse`. Pipes make code more intuitive and easier to understand - which is good for practicing open science! \n\nLet's compare code written with - and without - pipes. \n\nBelow you see how the ` %>% ` is used to pass information from one line to the next. It's easy to follow along and see exactly what is being done to the data, line by line. \n\n```{r, message=FALSE}\ngss_cat %>%\n  filter(relig == \"Protestant\") %>%\n  group_by(year, relig) %>%\n  summarise(tvhours = mean(tvhours, na.rm = TRUE))\n```\n\nIn contrast, the following code performs the same operations but without piping. To understand what is happening you need to read the code from the inside out - which is much more difficult. \n\n```{r, warning = FALSE, message=FALSE}\n# Using base R\nsummarise(group_by(filter(gss_cat, \n                          relig == \"Protestant\"), \n                   year, \n                   relig), \n          tvhours = mean(tvhours, \n                         na.rm = TRUE)\n          )\n```\n\nPipes don't (automatically) assign a new object as a result of the operations you make. You need to specify `<-`  at the beginning if you wish to save the results. There is a special variation of the pipe that allows assignments, ` %<>%`  but it is less obvious than `<-`. \n\nPipes are not appropriate for every situation. You should consider not using pipes when:\n\n* The sequence of operations is longer than 10 steps. In this situation, it is useful to break up the code into intermediate steps and assign them to objects. This will be helpful if you need to identify any problems. \n* You have multiple inputs and outputs. If you are transforming more than one object it is better not to use pipes. \n\n*Note: `Cmd + Shift + M` (Mac) and `Ctrl + Shift + M` is a useful shorthand for the ` %>% `.*\n\n------------------------------------------------------------------------\n\n# Part 3: Data transformation\n\nIn this section we will practice data transformation using functions from the `dplyr` package in the core tidyverse. You should be familiar with some of these functions already, but today we will go a little further.\n\nRemember to use the ` %>% ` operator!\n\n\n## Filtering data\n\nThe `filter()` function allows you to subset observations based on their values. The first argument is the name of the data frame. The second and subsequent arguments are the expressions that filter the data frame.\n\nR provides the following options for filtering: `>`, `>=`, `<`, `<=`, `!=` (not equal), and `==` (equal). You can also combine these with the following logical operators: `&` meaning \"and\", `|` meaning \"or\", and `!` meaning \"not\". \n\n1. **Use the `filter()` function to display only married people in the gss_cat data set.**\n\n```{r, include = params$answers}\ngss_cat %>% \n  filter(marital == \"Married\")\n\n# Since we only want to find married people we will use the equal operator, ==, and encase the observations we want in quotes.*\n```\n\n2. **Use the `filter()` function to display divorced AND widowed people in the gss_cat data set.**\n```{r, include = params$answers}\ngss_cat %>% \n  filter(marital == \"Divorced\" | marital == \"Widowed\")\n\n# In this case we need to combine logical operators. The or operator is appropriate here since we are looking for two kinds of matches in the same variable (& would not work since people cannot be both divorced and widowed). We combine this with the equal operator.\n```\n\n## Arranging data\n\n3. **Use the `arrange()` function to reorder the information in the data frame by the number of tv hours.**\n\n```{r, include = params$answers}\ngss_cat %>% \n  arrange(tvhours)\n\n# Arrange only needs one argument, the variable you wish to reorder. Arrange orders the rows of a gss_cat by the tvhours column. The default here is to arrange in ascending order.\n```\n\n4. **You can combine arrange() with functions like `desc()` to re-order a column in descending order. Try doing this.**\n\n```{r, include = params$answers}\ngss_cat %>%\n  arrange(desc(tvhours))\n\n# When combining these functions you need to wrap arrange around the operation you want to do.\n```\n\n5. **How would you filter only married people and arrange them by how much tv they watch?**\n\n**Hint: You need to combine filter and arrange using the %>%**\n\n```{r, include = params$answers}\ngss_cat %>% \n  filter(marital == \"Married\") %>% \n  arrange(tvhours)\n\n# Using the pipe we can perform multiple operations at once without needing to save each interim step as an object.\n```\n\n6. **How would you use `arrange()` and `count()` to find what the most common religion is?**\n\n```{r, include = params$answers}\ngss_cat %>%\n  count(relig) %>%\n  arrange(desc(n))\n\n# In this case, we are not passing a variable to arrange but a logical, n. This tells R to count all the categories in relig and subsequently order these categories in descending order.*\n```\n\n## Summarizing data\n\n7. **How many hours of tv on average are watched by people of different religions?**\n\n**Hint: `select()`, `group_by()`, and `summarize()` are useful functions for this**\n\n```{r, include = params$answers}\ngss_cat %>%\n  select(relig, tvhours) %>% # also works without using select\n  group_by(relig) %>% \n  summarise(tvhours = mean(tvhours, na.rm = TRUE))\n\n# Combining several operations can seem complex, but once you understand what is happening you can apply to most other cases. In this example we tell R to take the `gss_data`, select only `relig` and `tvhours`, group the different categories of `relig` and perform a summarising function on these groups in respect to tvhours. Inside the `summarise()` function we tell it to take an average and to remove missing values.* \n```\n\n","srcMarkdownNoYaml":"\n\nFrom the [Open Statistical Programming](https://www.openstatprog.com/) modules, complete the following:\n\n-   Reproducible reporting\n\n-   External data\n\n------------------------------------------------------------------------\n\n\n# Introduction\n\nWelcome to the first practical of Fundamental Techniques in Data Science with R! In this part of the practical, you will learn about \n\n* Pipes\n* Data transformation \n\n---\n\nWe will work with the following packages today: \n```{r, message=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(kableExtra)\n```\n\n\nWe are going to use the General Social Survey, which is a long-running [US survey](https://gss.norc.org/) conducted by the NORC at the University of Chicago. The survey monitors changes in social characteristics and attitudes. The survey is quite large, so we can access a smaller version in the `forcats` package. It has the following variables:\n\n* **year**: year of the survey from 2000-2014\n* **marital**: marital status\n* **age**: max age is truncated to 89\n* **race**\n* **rincome**: reported income\n* **partyid**: political affiliation\n* **relig**: religion\n* **denom**: denomination \n* **tvhours**: hours per day watching tv\n\nIf you want more information on the survey you can type `?gss_cat` into the console. \nLet's load the data. \n\n```{r}\ngss_cat <- forcats::gss_cat\n```\n\nWe can take a look at the data using `head()`, which shows us the first 6 rows of the data frame. \n\n```{r}\nhead(gss_cat)\n```\n\nThe `str()` function tells us what the class of each variable is. You will notice that most variables in the gss_cat data are factors with different levels. In this tutorial we will work mainly with these variables to learn techniques for working with factors. \n\n```{r}\nstr(gss_cat)\n```\n\n# Part 2: Pipes\n\nPipes are a useful tool that make it easier to express a sequence of multiple operations in R. Pipes ` %>% ` come from the `magrittr` package, so they are automatically loaded when you use the `tidyverse`. Pipes make code more intuitive and easier to understand - which is good for practicing open science! \n\nLet's compare code written with - and without - pipes. \n\nBelow you see how the ` %>% ` is used to pass information from one line to the next. It's easy to follow along and see exactly what is being done to the data, line by line. \n\n```{r, message=FALSE}\ngss_cat %>%\n  filter(relig == \"Protestant\") %>%\n  group_by(year, relig) %>%\n  summarise(tvhours = mean(tvhours, na.rm = TRUE))\n```\n\nIn contrast, the following code performs the same operations but without piping. To understand what is happening you need to read the code from the inside out - which is much more difficult. \n\n```{r, warning = FALSE, message=FALSE}\n# Using base R\nsummarise(group_by(filter(gss_cat, \n                          relig == \"Protestant\"), \n                   year, \n                   relig), \n          tvhours = mean(tvhours, \n                         na.rm = TRUE)\n          )\n```\n\nPipes don't (automatically) assign a new object as a result of the operations you make. You need to specify `<-`  at the beginning if you wish to save the results. There is a special variation of the pipe that allows assignments, ` %<>%`  but it is less obvious than `<-`. \n\nPipes are not appropriate for every situation. You should consider not using pipes when:\n\n* The sequence of operations is longer than 10 steps. In this situation, it is useful to break up the code into intermediate steps and assign them to objects. This will be helpful if you need to identify any problems. \n* You have multiple inputs and outputs. If you are transforming more than one object it is better not to use pipes. \n\n*Note: `Cmd + Shift + M` (Mac) and `Ctrl + Shift + M` is a useful shorthand for the ` %>% `.*\n\n------------------------------------------------------------------------\n\n# Part 3: Data transformation\n\nIn this section we will practice data transformation using functions from the `dplyr` package in the core tidyverse. You should be familiar with some of these functions already, but today we will go a little further.\n\nRemember to use the ` %>% ` operator!\n\n\n## Filtering data\n\nThe `filter()` function allows you to subset observations based on their values. The first argument is the name of the data frame. The second and subsequent arguments are the expressions that filter the data frame.\n\nR provides the following options for filtering: `>`, `>=`, `<`, `<=`, `!=` (not equal), and `==` (equal). You can also combine these with the following logical operators: `&` meaning \"and\", `|` meaning \"or\", and `!` meaning \"not\". \n\n1. **Use the `filter()` function to display only married people in the gss_cat data set.**\n\n```{r, include = params$answers}\ngss_cat %>% \n  filter(marital == \"Married\")\n\n# Since we only want to find married people we will use the equal operator, ==, and encase the observations we want in quotes.*\n```\n\n2. **Use the `filter()` function to display divorced AND widowed people in the gss_cat data set.**\n```{r, include = params$answers}\ngss_cat %>% \n  filter(marital == \"Divorced\" | marital == \"Widowed\")\n\n# In this case we need to combine logical operators. The or operator is appropriate here since we are looking for two kinds of matches in the same variable (& would not work since people cannot be both divorced and widowed). We combine this with the equal operator.\n```\n\n## Arranging data\n\n3. **Use the `arrange()` function to reorder the information in the data frame by the number of tv hours.**\n\n```{r, include = params$answers}\ngss_cat %>% \n  arrange(tvhours)\n\n# Arrange only needs one argument, the variable you wish to reorder. Arrange orders the rows of a gss_cat by the tvhours column. The default here is to arrange in ascending order.\n```\n\n4. **You can combine arrange() with functions like `desc()` to re-order a column in descending order. Try doing this.**\n\n```{r, include = params$answers}\ngss_cat %>%\n  arrange(desc(tvhours))\n\n# When combining these functions you need to wrap arrange around the operation you want to do.\n```\n\n5. **How would you filter only married people and arrange them by how much tv they watch?**\n\n**Hint: You need to combine filter and arrange using the %>%**\n\n```{r, include = params$answers}\ngss_cat %>% \n  filter(marital == \"Married\") %>% \n  arrange(tvhours)\n\n# Using the pipe we can perform multiple operations at once without needing to save each interim step as an object.\n```\n\n6. **How would you use `arrange()` and `count()` to find what the most common religion is?**\n\n```{r, include = params$answers}\ngss_cat %>%\n  count(relig) %>%\n  arrange(desc(n))\n\n# In this case, we are not passing a variable to arrange but a logical, n. This tells R to count all the categories in relig and subsequently order these categories in descending order.*\n```\n\n## Summarizing data\n\n7. **How many hours of tv on average are watched by people of different religions?**\n\n**Hint: `select()`, `group_by()`, and `summarize()` are useful functions for this**\n\n```{r, include = params$answers}\ngss_cat %>%\n  select(relig, tvhours) %>% # also works without using select\n  group_by(relig) %>% \n  summarise(tvhours = mean(tvhours, na.rm = TRUE))\n\n# Combining several operations can seem complex, but once you understand what is happening you can apply to most other cases. In this example we tell R to take the `gss_data`, select only `relig` and `tvhours`, group the different categories of `relig` and perform a summarising function on these groups in respect to tvhours. Inside the `summarise()` function we tell it to take an average and to remove missing values.* \n```\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"lab2.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","editor":"visual","theme":["lumen"],"title":"Lab 1","params":{"answers":false}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}