---
title: "Lab 2"
#output-file: "lab2_answers.html"
output-file: "lab2.html"
params:
  answers: false
---

# Part 1: Open Statistical Programming modules

From the [Open Statistical Programming](https://www.openstatprog.com/) modules, complete the following:

-   Descriptive statistics

-   GGplot

------------------------------------------------------------------------

# Part 2: Linear regression

We will use the following packages in this practical:

```{r, message=FALSE, warning=FALSE}
library(dplyr)
library(magrittr)
library(ggplot2)
library(gridExtra)
```

In this practical, you will learn how to perform regression analyses in `R` using `lm()` and inspect variables by plotting these variables, using `ggplot()`, repeating some topics of the last 3 weeks.

## Loading the dataset

In the this practical, we will use the built-in data set `iris`. This data set contains the measurement of different iris species (flowers), you can find more information [here](https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/iris).

1.  **Load the dataset and explain what variables are measured in the first three columns of your data set.**

```{r, include = params$answers}
data <- iris # load the data
head(iris)   # inspect the data

# The data set contains three different kinds of flowers. The petal leaves and sepal leaves are measured in length and width. All measurements are in centimeters.
```

## Inspecting the dataset

A good way of eyeballing on a relation between two continuous variables is by creating a scatterplot.

2.  **Plot the sepal length and the petal width variables in a `ggplot` scatter plot (`geom_points`)**

```{r, message=FALSE, include = params$answers}
ggplot(data) +
  geom_point(aes(Sepal.Length, Petal.Width)) +
  xlab("Sepal length (in cm)") +
  ylab("Petal width (in cm)") +
  labs(col = "Species") +
  theme_minimal() +
  ggtitle("Plot of 2 continous variables")  + 
  theme(plot.title = element_text(hjust = 0.5))
```

A loess curve can be added to the plot to get a general idea of the relation between the two variables. You can add a loess curve to a ggplot with `stat_smooth(method = "loess")`.

3.  **Add a loess curve to the plot under question 2, for further inspection.**

```{r, message=FALSE, include = params$answers}
ggplot(data, aes(x = Sepal.Length, y = Petal.Width)) +
  geom_point() +
  stat_smooth(method = "loess", se=F, col = "blue") +
  xlab("Sepal length (in cm)") +
  ylab("Petal width (in cm)") +
  labs(col = "Species") +
  theme_minimal() +
  ggtitle("Plot of 2 continous variables")  + 
  theme(plot.title = element_text(hjust = 0.5))

# The curve is added to the previous plot by the line `stat_smooth(method = "loess, se = F, col = "blue")`.
```

To get a clearer idea of the general trend in the data (or of the relation), a regression line can be added to the plot. A regression line can be added in the same way as a loess curve, the method argument in the function needs to be altered to `lm` to do so.

4.  **Change the loess curve of the previous plot to a regression line. Describe the relation that the line indicates.**

```{r, message=FALSE, include = params$answers}
# In comparison to the previous plot, we now adjust "method = "loess"" to "method = "lm"".
ggplot(data, aes(x = Sepal.Length, y = Petal.Width)) +
  geom_point() +
  stat_smooth(method = "lm", se=F, col = "blue") +
  xlab("Sepal length (in cm)") +
  ylab("Petal width (in cm)") +
  labs(col = "Species") +
  theme_minimal() +
  ggtitle("Plot of 2 continous variables")  + 
  theme(plot.title = element_text(hjust = 0.5))

# The line indicates that there seems to be a more or less linear positive relation between the two plotted variables. This means that an increase in sepal length probably indicates an increase in petal width as well.
```

## Simple linear regression

With the `lm()` function, you can specify a linear regression model. You can save a model in an object and request summary statistics with the `summary()` command. The model is always specified with the code `outcome_variable ~ predictor`.

When a model is stored in an object, you can ask for the coefficients with `coefficients()`. The next code block shows how you would specify a model where petal width is predicted by sepal width, and how summary statistics for this model would look like

```{r}
# Specify model: outcome = petal width, predictor = sepal width
iris_model1 <- lm(Petal.Width ~ Sepal.Width,
                  data = iris)

summary(iris_model1)
```

The summary of the model provides:

-   The model formula;

-   Estimated coefficients (with standard errors and their significance tests);

-   Information on the residuals;

-   A general test for the significance of the model (F-test);

-   The (adjusted) R squared as a metric for model performance.

Individual elements can be extracted by calling specific model elements (e.g. `iris_model1$coefficients`).

5.  **Specify a regression model where Sepal length is predicted by Petal width. Store this model as \`model1. Supply summary statistics for this model.**

```{r, include = params$answers}
# specify model
model1 <- lm(Sepal.Length ~ Petal.Width, 
             data = data)

# ask for summary
summary(model1)
```

6.  **Based on the summary of the model, give a substantive interpretation of the regression coefficient.**

```{r, include = params$answers}
# The regression coefficient indicates the amount of change in the predicted variable when the predictor variable is changed with one unit. In case of the example model, this means that for every centimeter increase in the width of a petal leaf, the predicted length of a sepal leaf increases by 0.89 cm.
```

7.  **Relate the summary statistics and coefficients to the plots you made in questions 2 - 4.**

```{r, include = params$answers}
# The coefficients seem to be in accordance with the earlier plots. They are not exactly the same, but indicate a similar positive relationship.
```
